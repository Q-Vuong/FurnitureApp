<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <link href="/css/component/navigation.css" rel="stylesheet">
    <link href="/css/component/breadcrumb.css" rel="stylesheet">
    <link href="/css/pages/banner.css" rel="stylesheet">

</head>

<body>

    <div class="container">
        {{#if successMessage}}
        <div class="alert alert-success" role="alert">
            {{successMessage}}
        </div>
        {{/if}}
        {{#if dangerMessage}}
        <div class="alert alert-danger" role="alert">
            {{dangerMessage}}
        </div>
        {{/if}}


        <div id="add-or-edit-banner">
            <h5 class="mb-4">{{viewTitle}}</h5>
            <hr class="mb-4">
            <form id="productForm" action="/product/add" method="POST" enctype="multipart/form-data">
                <input type="hidden" id="id" name="id" value="{{products._id}}">
                <div class="mb-3">
                    <label for="imageInput" class="form-label">Ảnh: </label>
                    <input type="file" class="form-control" id="imagePr" name="productImage" accept="image/*">
                    <img src="{{products.imagePr}}" id="imagePreview" class="mt-2" style="max-width: 150px;">
                </div>
                <div class="mb-3">
                    <label for="nameInput" class="form-label">Tên: </label>
                    <input type="text" class="form-control" id="namePr" name="namePr" value="{{products.namePr}}"
                        required>
                </div>
                <div class="mb-3">
                    <label for="sizeInput" class="form-label">Kích thước: </label>
                    <input type="text" class="form-control" id="sizeInput" name="size" value="{{products.size}}">
                </div>
                <div class="mb-3">
                    <label for="priceInput" class="form-label">Giá: </label>
                    <input type="number" class="form-control" id="priceInput" name="price" value="{{products.price}}"
                        required>
                </div>
                {{!-- <div class="mb-3">
                    <label for="discountInput" class="form-label">Giảm giá: </label>
                    <input type="text" class="form-control" id="discountInput" name="discount"
                        value="{{products.discount}}">
                </div> --}}
                <div class="mb-3">
                    <label for="quantityInput" class="form-label">Kho: </label>
                    <input type="number" class="form-control" id="quantityInput" name="quantity"
                        value="{{products.quantity}}" required>
                </div>
                <div class="mb-3">
                    <label for="typeInput" class="form-label">Danh mục: </label>
                    <input type="hidden" class="form-control" list="typeInputs" name="type" id="typeInput"
                        value="{{products.type._id}}">
                    <input class="form-control" list="typeInputs" name="typeName" id="typeInputName"
                        value="{{products.type.nameType}}"
                        placeholder="-------- Nhấn vào để chọn hoặc tìm kiếm một danh mục ---------">
                    <datalist id="typeInputs">
                        {{#each productTypes}}
                        <option value="{{this.nameType}}" data-id="{{this._id}}">{{this.nameType}}</option>
                        {{/each}}
                    </datalist>
                </div>
                <div class="mb-3">
                    <label for="descriptionInput" class="form-label">Mô tả: </label>
                    <textarea class="form-control" id="descriptionInput" name="description"
                        required>{{products.description}}</textarea>
                </div>
                <div class="mb-3">
                    <label for="isNewInput" class="form-label">Sản phẩm mới: </label>
                    <input type="checkbox" class="form-check-input" id="isNewInput" name="isNew" value="true" {{#if
                        products.isNew}}checked{{/if}}>
                </div>

                <div class="mb-3">
                    <label for="featuredInput" class="form-label">Nổi bật: </label>
                    <input type="checkbox" class="form-check-input" id="featuredInput" name="featured" value="true"
                        {{#if products.featured}}checked{{/if}}>
                </div>

                <button type="submit" class="btn btn-primary" id="addproduct">Thực hiện</button>
                <a href="/product/view" onclick="return confirmAction(event);" class="btn btn-danger ">Huỷ</a>
            </form>

        </div>

    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="/js/products/loadPage_pr.js"></script>
    <script>
        document.getElementById('typeInputName').addEventListener('input', function (event) {
            var typeInputName = event.target;
            var selectedOption = document.querySelector(`option[value="${typeInputName.value}"]`);
            var typeInput = document.getElementById('typeInput');
            if (selectedOption) {
                typeInputName.value = selectedOption.innerText; // Hiển thị nameType
                typeInput.value = selectedOption.dataset.id; // Lấy giá trị _id
            } else {
                typeNameInput.value = ''; // Xóa hiển thị nếu không có tùy chọn
                typeInput.value = '';
            }
        });
    </script>
    <script>
        // Hiển thị ảnh trước khi tải lên
        document.getElementById('imagePr').addEventListener('change', function (event) {
            var imageInput = event.target;
            var imagePreview = document.getElementById('imagePreview');
            var file = imageInput.files[0];
            var reader = new FileReader();
            reader.onload = function (e) {
                imagePreview.src = e.target.result;
            };
            reader.readAsDataURL(file);
        });    
    </script>




</body>

</html>